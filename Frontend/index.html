<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FDG Constructions | AI-Powered Project Planner in Dallas, TX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <!-- HubSpot Forms Integration -->
    <script src="https://js.hsforms.net/forms/embed/50137499.js" defer></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-yellow: #FCD34D; --primary-yellow-hover: #F59E0B; --dark-bg: #0F0F0F;
            --card-bg: #1A1A1A; --border-color: #333333; --text-primary: #FFFFFF;
            --text-secondary: #A1A1AA; --text-muted: #71717A; --accent-blue: #3B82F6;
            --accent-green: #10B981; --accent-purple: #8B5CF6; --glass-bg: rgba(26, 26, 26, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1A1A1A 100%);
            color: var(--text-primary); 
            overflow-x: hidden;
        }

        #particles-js { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }

        .glass-card {
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-yellow-hover));
            color: var(--dark-bg); font-weight: 700; padding: 16px 32px; border-radius: 12px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(252, 211, 77, 0.3);
            position: relative; overflow: hidden; cursor: pointer;
        }
        .btn-primary::before {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn-primary:hover::before { left: 100%; }
        .btn-primary:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 12px 35px rgba(252, 211, 77, 0.4); }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1); color: var(--text-primary); font-weight: 600;
            padding: 12px 24px; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease; backdrop-filter: blur(10px); cursor: pointer;
        }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }

        .section-title {
            font-size: clamp(2.5rem, 6vw, 4rem); font-weight: 900; text-align: center; margin-bottom: 2rem;
            background: linear-gradient(135deg, var(--primary-yellow), #FFD700, var(--primary-yellow-hover));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            position: relative; letter-spacing: -0.02em;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary-yellow), var(--accent-blue));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* Enhanced Chat System */
        .chat-container {
            background: var(--glass-bg); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
            padding: 24px; min-height: 500px; max-height: 650px; overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); display: flex; flex-direction: column; gap: 16px;
        }

        @keyframes slide-in-left { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slide-in-right { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

        .chat-bubble { padding: 16px 20px; border-radius: 18px; max-width: 85%; word-wrap: break-word; line-height: 1.6; }

        .chat-bubble-ai {
            background: linear-gradient(135deg, #2A2A2A, #222222); color: var(--text-primary);
            border-radius: 18px 18px 18px 4px; align-self: flex-start; animation: slide-in-left 0.4s ease-out forwards;
        }

        .chat-bubble-user {
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-yellow-hover)); color: var(--dark-bg);
            border-radius: 18px 18px 4px 18px; align-self: flex-end; font-weight: 500;
            animation: slide-in-right 0.4s ease-out forwards;
        }

        .chat-input-container { display: flex; gap: 12px; margin-top: 16px; }
        .chat-input {
            flex: 1; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 15px;
            padding: 16px 20px; color: var(--text-primary); font-size: 16px;
            transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .chat-input:focus { 
            outline: none; border-color: var(--primary-yellow); 
            box-shadow: 0 0 0 3px rgba(252, 211, 77, 0.2), 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .typing-indicator { display: flex; align-items: center; gap: 5px; padding: 16px 20px; }
        .typing-indicator span {
            height: 8px; width: 8px; background-color: var(--text-muted); border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; } .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }

        /* HubSpot Form Section */
        .hubspot-form-section {
            background: var(--card-bg); border: 1px solid var(--border-color);
            border-radius: 16px; padding: 24px; margin-top: 3rem;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }
        .hubspot-form-section .hs-form-field label { color: var(--text-primary) !important; font-weight: 600 !important; }
        .hubspot-form-section .hs-form-field input[type="text"], 
        .hubspot-form-section .hs-form-field input[type="email"],
        .hubspot-form-section .hs-form-field input[type="tel"],
        .hubspot-form-section .hs-form-field textarea, 
        .hubspot-form-section .hs-form-field select {
            background-color: var(--dark-bg) !important; border: 2px solid var(--border-color) !important;
            color: var(--text-primary) !important; width: 100% !important; padding: 10px 15px !important; border-radius: 8px !important;
        }
        .hubspot-form-section .hs-form-field input[type="radio"],
        .hubspot-form-section .hs-form-field input[type="checkbox"] {
             margin-right: 8px !important; accent-color: var(--primary-yellow) !important;
        }
        .hubspot-form-section .hs-button {
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-yellow-hover)) !important;
            color: var(--dark-bg) !important; font-weight: 700 !important; border: none !important; padding: 16px 32px !important; border-radius: 12px !important;
        }
        .hubspot-form-section .hs-richtext, .hubspot-form-section p { color: var(--text-secondary) !important; }
        /* Styles for HubSpot radio buttons/checkboxes to fit the theme */
        .hubspot-form-section .choices__list--multiple, .hubspot-form-section .choices__item--selectable { color: var(--text-primary) !important; }
        .hubspot-form-section .choices__inner { background-color: var(--dark-bg) !important; border: 2px solid var(--border-color) !important; }


        .service-card {
            background: var(--glass-card); backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
            padding: 30px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative; overflow: hidden;
        }
        .service-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
            background: linear-gradient(90deg, var(--primary-yellow), var(--accent-blue), var(--accent-green));
        }
        .service-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(252, 211, 77, 0.2);
        }

        .stat-number { font-size: 3rem; font-weight: 900; color: var(--primary-yellow); }

        .toggle-panel { max-height: 0; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .toggle-panel.active { max-height: 1000px; }

        .fab {
            position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
            background: linear-gradient(135deg, var(--primary-yellow), var(--primary-yellow-hover));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 8px 25px rgba(252, 211, 77, 0.4); color: var(--dark-bg);
            font-size: 24px; transition: all 0.3s ease; z-index: 1000; cursor: pointer;
        }
        .fab:hover { transform: scale(1.1); box-shadow: 0 12px 35px rgba(252, 211, 77, 0.6); }

        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .float-animation { animation: float 3s ease-in-out infinite; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--dark-bg); }
        ::-webkit-scrollbar-thumb { background: var(--primary-yellow); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-yellow-hover); }

        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); }
        .modal-content { background: var(--card-bg); margin: 5% auto; padding: 30px; border-radius: 20px; width: 90%; max-width: 600px; position: relative; }
        .close { color: var(--text-secondary); float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: var(--primary-yellow); }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    
    <div class="fab" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <header class="flex justify-between items-center py-6 relative z-10">
            <div class="flex items-center space-x-4">
                <img src="https://i.imgur.com/8hY1zXj.png" alt="FDG Constructions Logo" class="h-16 md:h-24 float-animation">
                <div class="hidden md:block">
                    <h1 class="text-3xl font-bold gradient-text">FDG Constructions</h1>
                    <p class="text-sm text-gray-400">Your Dallas Construction & Remodeling Experts</p>
                </div>
            </div>
            
            <nav class="hidden lg:flex space-x-8 items-center">
                <a href="#services" class="hover:text-yellow-400 transition-colors">Services</a>
                <a href="#ai-planner" class="hover:text-yellow-400 transition-colors">AI Planner</a>
                <a href="#about" class="hover:text-yellow-400 transition-colors">About Us</a>
                <a href="#testimonials" class="hover:text-yellow-400 transition-colors">Testimonials</a>
                <a href="#contact" class="hover:text-yellow-400 transition-colors">Contact</a>
                <a href="tel:+14304445162" class="btn-primary text-lg flex items-center">
                    <i class="fas fa-phone mr-2"></i>(430) 444-5162
                </a>
            </nav>
            
            <div class="flex items-center space-x-4">
                <button onclick="toggleMenu()" class="lg:hidden text-3xl">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </header>

        <div id="mobile-menu" class="lg:hidden hidden bg-card-bg rounded-lg p-4 mt-4 border border-border-color">
            <a href="#services" class="block py-3 px-2 hover:text-yellow-400 transition-colors">Services</a>
            <a href="#ai-planner" class="block py-3 px-2 hover:text-yellow-400 transition-colors">AI Planner</a>
            <a href="#about" class="block py-3 px-2 hover:text-yellow-400 transition-colors">About Us</a>
            <a href="#testimonials" class="block py-3 px-2 hover:text-yellow-400 transition-colors">Testimonials</a>
            <a href="#contact" class="block py-3 px-2 hover:text-yellow-400 transition-colors">Contact</a>
             <a href="tel:+14304445162" class="block py-3 px-2 mt-2 btn-primary text-center">Call Us: (430) 444-5162</a>
        </div>

        <main>
            <section class="text-center py-20 md:py-32 relative min-h-screen flex items-center justify-center">
                <div class="relative z-10" data-aos="fade-up" data-aos-duration="1000">
                    <h1 class="text-5xl md:text-7xl font-extrabold mb-6 leading-tight">
                        Dallas's Premier <span class="gradient-text">Construction & Remodeling</span> Partner
                    </h1>
                    <p class="text-xl md:text-2xl text-gray-300 mb-12 max-w-4xl mx-auto">
                        We bring your vision to life with unparalleled craftsmanship, innovative solutions, and a commitment to excellence, powered by AI.
                    </p>
                    
                    <div class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-16">
                        <a href="#ai-planner" class="btn-primary text-xl">
                            <i class="fas fa-robot mr-2"></i>Start Your AI Project Plan
                        </a>
                        <a href="tel:+14304445162" class="btn-secondary text-xl flex items-center">
                            <i class="fas fa-phone mr-2"></i>Talk to an Expert
                        </a>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-8 max-w-5xl mx-auto mt-16 relative z-10" data-aos="fade-up" data-aos-delay="200">
                    <div class="text-center p-4 glass-card">
                        <div class="stat-number" data-count="776">0</div>
                        <p class="text-gray-400 mt-2">Projects Completed</p>
                    </div>
                    <div class="text-center p-4 glass-card">
                        <div class="stat-number" data-count="97">0</div>
                        <p class="text-gray-400 mt-2">% Satisfaction Rate</p>
                    </div>
                    <div class="text-center p-4 glass-card">
                        <div class="stat-number" data-count="15">0</div>
                        <p class="text-gray-400 mt-2">Years Experience</p>
                    </div>
                    <div class="text-center p-4 glass-card">
                        <div class="stat-number" data-count="52">0</div>
                        <p class="text-gray-400 mt-2">Expert Contractors</p>
                    </div>
                </div>
            </section>

            <section id="services" class="py-20">
                <div class="text-center mb-16" data-aos="fade-up">
                    <h2 class="section-title">Our Core Services</h2>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">We handle everything from initial planning to final touches, ensuring quality and efficiency.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Service Card 1: Roofing Construction -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="100">
                        <div class="text-center mb-6">
                            <i class="fas fa-home text-5xl text-yellow-400 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-4">Roofing Construction</h3>
                        </div>
                        <p class="text-gray-300 mb-6">Expert installation, repair, and replacement for all types of roofing, ensuring durability and protection.</p>
                        <button onclick="toggleInfo('roofing-info')" class="btn-secondary w-full">
                            <i class="fas fa-info-circle mr-2"></i>View Details
                        </button>
                        <div id="roofing-info" class="toggle-panel mt-4 p-4 bg-gray-800 rounded-lg">
                            <h4 class="font-bold mb-2 text-primary-yellow">Roofing Services:</h4>
                            <ul class="space-y-1 text-gray-300 text-left">
                                <li>• Residential Roof Installation</li>
                                <li>• Commercial Roofing Solutions</li>
                                <li>• Storm Damage Repair (Hail/Wind)</li>
                                <li>• Preventative Maintenance</li>
                                <li>• Insurance Claim Assistance</li>
                            </ul>
                            <p class="mt-3 text-sm text-gray-400">Focusing on quality materials and expert workmanship for lasting results.</p>
                        </div>
                    </div>
                    
                    <!-- Service Card 2: Home Remodeling -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="text-center mb-6">
                            <i class="fas fa-paint-roller text-5xl text-blue-400 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-4">Home Remodeling</h3>
                        </div>
                        <p class="text-gray-300 mb-6">Transform your living space with our comprehensive remodeling services, from kitchens to bathrooms.</p>
                        <button onclick="toggleInfo('remodeling-info')" class="btn-secondary w-full">
                            <i class="fas fa-info-circle mr-2"></i>View Details
                        </button>
                        <div id="remodeling-info" class="toggle-panel mt-4 p-4 bg-gray-800 rounded-lg">
                            <h4 class="font-bold mb-2 text-accent-blue">Remodeling Expertise:</h4>
                            <ul class="space-y-1 text-gray-300 text-left">
                                <li>• Kitchen & Bathroom Renovations</li>
                                <li>• Interior & Exterior Updates</li>
                                <li>• Flooring, Painting, & Fixtures</li>
                                <li>• Custom Cabinetry & Countertops</li>
                                <li>• Smart Home Integrations</li>
                            </ul>
                             <p class="mt-3 text-sm text-gray-400">Creating beautiful, functional spaces tailored to your lifestyle.</p>
                        </div>
                    </div>

                    <!-- Service Card 3: Custom Construction -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="300">
                        <div class="text-center mb-6">
                            <i class="fas fa-building text-5xl text-green-400 mb-4"></i>
                            <h3 class="text-2xl font-bold mb-4">Custom Construction</h3>
                        </div>
                        <p class="text-gray-300 mb-6">Building your dream from the ground up with precision and architectural integrity.</p>
                        <button onclick="toggleInfo('construction-info')" class="btn-secondary w-full">
                            <i class="fas fa-info-circle mr-2"></i>View Details
                        </button>
                        <div id="construction-info" class="toggle-panel mt-4 p-4 bg-gray-800 rounded-lg">
                            <h4 class="font-bold mb-2 text-accent-green">Construction Services:</h4>
                            <ul class="space-y-1 text-gray-300 text-left">
                                <li>• Custom Home Building</li>
                                <li>• Commercial Property Development</li>
                                <li>• Additions & Extensions</li>
                                <li>• Structural Modifications</li>
                                <li>• Project Management & Permits</li>
                            </ul>
                            <p class="mt-3 text-sm text-gray-400">Delivering structurally sound and aesthetically pleasing constructions.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="ai-planner" class="py-20">
                <div class="text-center mb-12" data-aos="fade-up">
                    <h2 class="section-title">Your AI-Powered Project Planner</h2>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">Let our intelligent assistant guide you through defining your project. It's quick, intuitive, and the first step to bringing your ideas to reality.</p>
                </div>
                
                <div class="max-w-4xl mx-auto" data-aos="fade-up" data-aos-delay="200">
                    <div class="chat-container" id="chat-container"></div>
                    <div id="chat-input-area" class="chat-input-container hidden">
                        <input type="text" id="chat-input" placeholder="Tell me about your project vision..." class="chat-input">
                        <button id="send-chat-btn" class="btn-primary"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </section>

            <!-- HubSpot Form Section (initially hidden, revealed by AI) -->
            <section id="hubspot-form-section" class="py-20 hidden opacity-0">
                <div class="text-center mb-12" data-aos="fade-up">
                    <h2 class="section-title">Finalize Your Project Details</h2>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">Please complete the following information to submit your project plan. Your details from the AI chat are pre-filled.</p>
                </div>
                <div class="max-w-3xl mx-auto" data-aos="fade-up" data-aos-delay="100">
                    <!-- HubSpot Form will be rendered here by the script -->
                    <div id="hubspot-form-target"></div> 
                </div>
            </section>

            <section id="about" class="py-20">
                <div class="max-w-6xl mx-auto">
                    <div class="text-center mb-16" data-aos="fade-up">
                        <h2 class="section-title">Why Partner with FDG Constructions?</h2>
                        <p class="text-xl text-gray-400 max-w-3xl mx-auto">We pride ourselves on blending Dallas's spirit of innovation with reliable, quality construction.</p>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                        <div data-aos="fade-right">
                            <div class="space-y-8">
                                <div class="flex items-start space-x-4">
                                    <div class="bg-yellow-400 rounded-full p-3 flex items-center justify-center w-14 h-14">
                                        <i class="fas fa-award text-black text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold mb-2">Award-Winning Dallas Team</h3>
                                        <p class="text-gray-300">Our local professionals are recognized for delivering exceptional results and client satisfaction.</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-4">
                                    <div class="bg-blue-400 rounded-full p-3 flex items-center justify-center w-14 h-14">
                                        <i class="fas fa-clock text-black text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold mb-2">On-Time, On-Budget</h3>
                                        <p class="text-gray-300">We respect your time and budget, ensuring projects are completed efficiently and as planned.</p>
                                    </div>
                                </div>
                                <div class="flex items-start space-x-4">
                                    <div class="bg-green-400 rounded-full p-3 flex items-center justify-center w-14 h-14">
                                        <i class="fas fa-shield-alt text-black text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-xl font-bold mb-2">Fully Insured & Licensed</h3>
                                        <p class="text-gray-300">Your peace of mind is paramount. We are fully insured and licensed for all our operations.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div data-aos="fade-left">
                            <div class="glass-card p-8 text-center">
                                <div class="text-6xl mb-6">
                                    <i class="fas fa-handshake text-yellow-400"></i>
                                </div>
                                <h3 class="text-2xl font-bold mb-4">Our Dallas Commitment</h3>
                                <p class="text-gray-300 mb-6">We're more than builders; we're your neighbors. FDG Constructions is dedicated to enhancing the Dallas community, one project at a time, with integrity and passion.</p>
                                <a href="#contact" class="btn-primary">Let's Build Together</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="portfolio" class="py-20">
                <div class="text-center mb-16" data-aos="fade-up">
                    <h2 class="section-title">Our Work in Dallas</h2>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">A glimpse into the quality and dedication we bring to every project in the Dallas area.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Example Project 1 -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="100">
                        <img src="https://images.unsplash.com/photo-1580587471535-307766685327?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Dallas Modern Home" class="rounded-lg mb-4 w-full h-64 object-cover">
                        <h3 class="text-xl font-bold mb-2">Modern Dallas Residence</h3>
                        <p class="text-gray-300 mb-4">Full-scale renovation of a contemporary home in North Dallas, focusing on open spaces and natural light.</p>
                        <button onclick="openModal('portfolio-modal-1')" class="btn-secondary w-full">
                            <i class="fas fa-eye mr-2"></i>View Project
                        </button>
                    </div>
                    <!-- Example Project 2 -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="200">
                        <img src="https://images.unsplash.com/photo-1600598916897-247123c70201?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Commercial Build Dallas" class="rounded-lg mb-4 w-full h-64 object-cover">
                        <h3 class="text-xl font-bold mb-2">Uptown Commercial Space</h3>
                        <p class="text-gray-300 mb-4">Complete build-out for a new retail space in Uptown Dallas, emphasizing modern aesthetics and functionality.</p>
                        <button onclick="openModal('portfolio-modal-2')" class="btn-secondary w-full">
                            <i class="fas fa-eye mr-2"></i>View Project
                        </button>
                    </div>
                    <!-- Example Project 3 -->
                    <div class="service-card" data-aos="fade-up" data-aos-delay="300">
                        <img src="https://images.unsplash.com/photo-1622132021208-36966312d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Dallas Kitchen Remodel" class="rounded-lg mb-4 w-full h-64 object-cover">
                        <h3 class="text-xl font-bold mb-2">Elegant Kitchen Remodel</h3>
                        <p class="text-gray-300 mb-4">Gourmet kitchen transformation in Highland Park, featuring custom cabinetry and high-end finishes.</p>
                        <button onclick="openModal('portfolio-modal-3')" class="btn-secondary w-full">
                            <i class="fas fa-eye mr-2"></i>View Project
                        </button>
                    </div>
                </div>
            </section>

            <section id="testimonials" class="py-20">
                <div class="text-center mb-16" data-aos="fade-up">
                    <h2 class="section-title">What Our Clients Say</h2>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">Hear directly from satisfied homeowners and businesses in the Dallas area.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Testimonial 1 -->
                    <div class="glass-card p-6" data-aos="fade-up" data-aos-delay="100">
                        <p class="text-gray-300 italic mb-4">"FDG Constructions transformed our outdated kitchen into a modern masterpiece. Their attention to detail and professionalism were outstanding. Highly recommend for any Dallas homeowner!"</p>
                        <div class="flex items-center">
                            <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Client 1" class="w-12 h-12 rounded-full mr-4 border-2 border-primary-yellow">
                            <div>
                                <h4 class="font-bold text-lg">Sarah K.</h4>
                                <p class="text-sm text-gray-400">University Park, Dallas</p>
                            </div>
                        </div>
                    </div>
                    <!-- Testimonial 2 -->
                    <div class="glass-card p-6" data-aos="fade-up" data-aos-delay="200">
                        <p class="text-gray-300 italic mb-4">"We needed a reliable contractor for our commercial property roof replacement. FDG delivered on time and on budget. Their team was efficient and kept us informed throughout the process."</p>
                        <div class="flex items-center">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Client 2" class="w-12 h-12 rounded-full mr-4 border-2 border-primary-yellow">
                            <div>
                                <h4 class="font-bold text-lg">Mark T.</h4>
                                <p class="text-sm text-gray-400">Downtown Dallas Business Owner</p>
                            </div>
                        </div>
                    </div>
                    <!-- Testimonial 3 -->
                    <div class="glass-card p-6" data-aos="fade-up" data-aos-delay="300">
                        <p class="text-gray-300 italic mb-4">"From the initial AI consultation to the final walkthrough, FDG Constructions made our home addition project seamless. Their communication was excellent, and the quality of work is top-notch. They truly understand Dallas living."</p>
                        <div class="flex items-center">
                            <img src="https://randomuser.me/api/portraits/men/65.jpg" alt="Client 3" class="w-12 h-12 rounded-full mr-4 border-2 border-primary-yellow">
                            <div>
                                <h4 class="font-bold text-lg">David R.</h4>
                                <p class="text-sm text-gray-400">Plano, TX</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer id="contact" class="text-center py-16 border-t border-gray-800 mt-20">
             <div class="mb-8">
                <img src="https://i.imgur.com/8hY1zXj.png" alt="FDG Constructions Logo" class="h-16 mx-auto">
             </div>
             <p class="text-gray-400 mb-6 text-lg max-w-xl mx-auto">Let FDG Constructions be your trusted partner in building and remodeling. We're committed to quality, innovation, and client satisfaction right here in Dallas.</p>
             <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-8 mb-8">
                <a href="tel:+14304445162" class="btn-primary text-lg flex items-center">
                    <i class="fas fa-phone mr-2"></i>Call Us: (430) 444-5162
                </a>
                <a href="#ai-planner" class="btn-secondary text-lg">
                    <i class="fas fa-robot mr-2"></i>Start AI Project Plan
                </a>
                <a href="mailto:contact@fdgconstructions.site" class="text-yellow-400 hover:text-yellow-300 transition-colors text-lg flex items-center">
                    <i class="fas fa-envelope mr-2"></i>Email Us
                </a>
             </div>
             <div class="flex justify-center space-x-6 mt-8">
                <a href="https://www.facebook.com/profile.php?id=61577760321860" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary-yellow transition-colors">
                    <i class="fab fa-facebook fa-2x"></i>
                </a>
                <!-- Add other social media links here if needed -->
             </div>
             <p class="text-gray-500 text-sm mt-8">© 2025 FDG Constructions LLC. All rights reserved. | Dallas, TX</p>
        </footer>
    </div>
    
    <!-- Modals for Portfolio -->
    <div id="portfolio-modal-1" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('portfolio-modal-1')">×</span>
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">Modern Dallas Residence</h2>
            <div class="aspect-w-16 aspect-h-9">
                 <iframe src="https://www.youtube.com/embed/your_video_id_1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="rounded-lg"></iframe>
                 <!-- Replace with actual video or image gallery -->
            </div>
            <p class="text-gray-300 mt-4">A detailed look at the complete renovation of a modern home in North Dallas, showcasing open-concept living and premium finishes.</p>
        </div>
    </div>
    <div id="portfolio-modal-2" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('portfolio-modal-2')">×</span>
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">Uptown Commercial Space</h2>
            <div class="aspect-w-16 aspect-h-9">
                 <iframe src="https://www.youtube.com/embed/your_video_id_2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="rounded-lg"></iframe>
                 <!-- Replace with actual video or image gallery -->
            </div>
            <p class="text-gray-300 mt-4">The transformation of a commercial property in Uptown Dallas, designed for a modern retail experience with a focus on client engagement.</p>
        </div>
    </div>
    <div id="portfolio-modal-3" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('portfolio-modal-3')">×</span>
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">Elegant Kitchen Remodel</h2>
            <div class="aspect-w-16 aspect-h-9">
                 <iframe src="https://www.youtube.com/embed/your_video_id_3" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="rounded-lg"></iframe>
                 <!-- Replace with actual video or image gallery -->
            </div>
            <p class="text-gray-300 mt-4">A luxurious kitchen remodel in Highland Park, featuring custom craftsmanship and high-end appliances for a gourmet cooking experience.</p>
        </div>
    </div>

    <!-- HubSpot Embed Code -->
    <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/50137499.js"></script>

    <script>
    // --- UI & ANIMATION FUNCTIONS ---
    function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }
    function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
    function toggleInfo(id) { 
        const panel = document.getElementById(id);
        panel.classList.toggle('active'); 
    }
    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    
    // Initialize AOS (Animate On Scroll)
    AOS.init({ 
        once: true,         // Animation only once
        duration: 800,      // Animation duration
        offset: 100,        // Offset (trigger point)
        easing: 'ease-in-out', // Easing function
    });

    // Initialize Particles.js background
    particlesJS("particles-js", {
        "particles": {
            "number": {"value": 60, "density": {"enable": true, "value_area": 800}},
            "color": {"value": "#FCD34D"}, // Primary Yellow
            "shape": {"type": "circle"},
            "opacity": {"value": 0.5, "random": true},
            "size": {"value": 3, "random": true},
            "line_linked": {"enable": false},
            "move": {"enable": true, "speed": 1, "direction": "none", "out_mode": "out"}
        },
        "interactivity": {
            "detect_on": "canvas",
            "events": {
                "onhover": {"enable": false},
                "onclick": {"enable": false}
            }
        }
    });

    // GSAP Stat Counter Animation
    gsap.utils.toArray(".stat-number").forEach(el => {
        const count = parseInt(el.getAttribute("data-count"), 10);
        gsap.from(el, {
            textContent: 0,
            duration: 2.5, // Increased duration for a smoother count
            ease: "power1.inOut",
            snap: { textContent: 1 }, // Snap to whole numbers
            scrollTrigger: { 
                trigger: el, 
                start: "top 85%", // Start animation when element is 85% into view
                toggleActions: "play none none none" // Play on enter, do nothing on leave
            }
        });
    });

    // --- CHAT & API LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        const chatContainer = document.getElementById('chat-container');
        const chatInputArea = document.getElementById('chat-input-area');
        const hubspotFormSection = document.getElementById('hubspot-form-section');
        
        // --- Configuration ---
        const HUBSPOT_PORTAL_ID = '50137499'; 
        const HUBSPOT_FORM_ID = 'bef93062-7f6b-4a7a-99cb-3ec2c84c9398'; 
        const API_BACKEND_URL = 'https://fdg-backend.onrender.com/api/generate'; 

        // --- State Variables ---
        let conversationHistory = [];
        let isWaitingForResponse = false;
        // Store collected data temporarily
        let collectedAiData = {}; 

        // --- Helper Functions ---
        const addMessage = (content, sender) => {
            const bubble = document.createElement('div');
            bubble.className = `chat-bubble chat-bubble-${sender}`;
            bubble.innerHTML = content; // Use innerHTML to allow for potential formatting like links
            chatContainer.appendChild(bubble);
            chatContainer.scrollTop = chatContainer.scrollHeight; // Auto-scroll to bottom
        };

        const showTypingIndicator = () => {
            if (document.getElementById('typing-indicator')) return; // Prevent duplicates
            const indicatorHTML = `<div id="typing-indicator" class="chat-bubble chat-bubble-ai typing-indicator"><span></span><span></span><span></span></div>`;
            chatContainer.insertAdjacentHTML('beforeend', indicatorHTML);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        };

        const hideTypingIndicator = () => {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        };
        
        const showInputArea = (show) => {
            chatInputArea.classList.toggle('hidden', !show);
            if (show) {
                const inputField = chatInputArea.querySelector('#chat-input');
                inputField.focus(); // Focus the input field when shown
            }
        };
        
        // Function to initialize and populate the HubSpot form
        const initializeHubSpotForm = () => {
            showInputArea(false); // Hide chat input
            hubspotFormSection.classList.remove('hidden'); // Show the HubSpot form section
            setTimeout(() => hubspotFormSection.classList.remove('opacity-0'), 100); // Fade in
            hubspotFormSection.scrollIntoView({ behavior: 'smooth', block: 'center' }); // Scroll to the form

            // Create the HubSpot form
            hbspt.forms.create({
                region: "na1", // Or your specific HubSpot region
                portalId: HUBSPOT_PORTAL_ID,
                formId: HUBSPOT_FORM_ID,
                target: '#hubspot-form-target', // Where to render the form
                onFormReady: function($form) {
                    // Pre-fill fields based on AI conversation using collectedAiData
                    
                    // Map AI collected data to HubSpot form field names
                    $form.find('input[name="firstname"]').val(collectedAiData.name?.split(' ')[0] || '').change();
                    $form.find('input[name="lastname"]').val(collectedAiData.name?.split(' ').slice(1).join(' ') || '').change();
                    $form.find('input[name="email"]').val(collectedAiData.email || '').change();
                    $form.find('input[name="phone"]').val(collectedAiData.phone || '').change();
                    $form.find('input[name="address"]').val(collectedAiData.address || '').change();
                    
                    // Handle dropdowns/radio buttons
                    // Use .val() for single select, or manage multiple selections for checkboxes/multi-selects
                    if (collectedAiData.propertyType) {
                        $form.find(`select[name="property_type"] option[value="${collectedAiData.propertyType}"]`).prop('selected', true).change();
                    }
                    if (collectedAiData.serviceTypeRequested) {
                         $form.find(`select[name="service_type_requested"] option[value="${collectedAiData.serviceTypeRequested}"]`).prop('selected', true).change();
                    }
                     if (collectedAiData.currentRoofCondition) {
                        $form.find(`select[name="current_roof_condition"] option[value="${collectedAiData.currentRoofCondition}"]`).prop('selected', true).change();
                    }
                    if (collectedAiData.specificLeadSource) {
                        $form.find(`input[name="specific_lead_source"]`).val(collectedAiData.specificLeadSource).change();
                    }
                     if (collectedAiData.leadSegmentationQualification) {
                        $form.find(`select[name="lead_segmentation_qualification"] option[value="${collectedAiData.leadSegmentationQualification}"]`).prop('selected', true).change();
                    }
                    if (collectedAiData.preferredDate) {
                        $form.find('input[name="preferred_inspection_project_start_date"]').val(collectedAiData.preferredDate).change();
                    }

                    // For the summary, use a text area field if available, e.g., 'project_details'
                    const projectSummary = `AI Chat Summary:\n\nName: ${collectedAiData.name || 'N/A'}\nEmail: ${collectedAiData.email || 'N/A'}\nPhone: ${collectedAiData.phone || 'N/A'}\nProperty Type: ${collectedAiData.propertyType || 'N/A'}\nService Type: ${collectedAiData.serviceTypeRequested || 'N/A'}\nRoof Condition: ${collectedAiData.currentRoofCondition || 'N/A'}\nAddress: ${collectedAiData.address || 'N/A'}\nPreferred Date: ${collectedAiData.preferredDate || 'N/A'}\nLead Source: ${collectedAiData.specificLeadSource || 'AI Chatbot'}\nPriority: ${collectedAiData.leadSegmentationQualification || 'N/A'}`;
                    
                    // Assuming a field named 'notes' or 'description' for the summary
                    if ($form.find('textarea[name="notes"]').length) {
                        $form.find('textarea[name="notes"]').val(projectSummary).change();
                    } else if ($form.find('textarea[name="description"]').length) {
                        $form.find('textarea[name="description"]').val(projectSummary).change();
                    } else {
                        console.warn("Could not find a suitable textarea for project summary.");
                    }
                },
                onFormSubmitted: function() {
                    // Display a success message within the chat interface
                    const userName = collectedAiData.name?.split(' ')[0] || 'Valued Client';
                    hubspotFormSection.innerHTML = `
                        <div class="text-center p-8 glass-card">
                            <h2 class="text-2xl font-bold text-primary-yellow mb-4">All Set, ${userName}!</h2>
                            <p class="text-lg text-gray-300">Your project plan has been submitted successfully. We'll be in touch soon!</p>
                        </div>
                    `;
                    addMessage("Your project details have been submitted. Thanks!", 'ai');
                }
            });
        };

        // Main function to interact with the AI backend
        const callAIAssistant = async (userInput) => {
            if (isWaitingForResponse || !userInput) return; 
            isWaitingForResponse = true;

            addMessage(userInput, 'user'); 
            conversationHistory.push({ role: 'user', parts: [{ text: userInput }] });
            
            showTypingIndicator(); 
            showInputArea(false); 

            try {
                const promptForBackend = `
                    You are an AI assistant for FDG Constructions, based in Dallas, TX. Your goal is to gather project details through a natural conversation.
                    
                    **Persona:** Friendly, professional, and efficient, with a Dallas-like helpfulness.
                    **Key Information to Collect (one by one, naturally):**
                    1.  **Name:** (e.g., "What's your name?") - Store in 'collectedAiData.name'
                    2.  **Email:** (e.g., "And what's the best email to reach you?") - Store in 'collectedAiData.email'
                    3.  **Phone Number:** (e.g., "Could I get your phone number as well?") - Store in 'collectedAiData.phone'
                    4.  **Property Type:** (e.g., "Is this for a residential or commercial property?") - Offer options: Residential (Single-Family), Residential (Multi-Family/Apartments), Small Commercial (Office/Retail), Large Commercial (Industrial/Retail), Institutional (School/Church), Homeowners Association (HOA). Store in 'collectedAiData.propertyType'
                    5.  **Service Type Requested:** (e.g., "What kind of service are you looking for?") - Offer options: Free Inspection, Roof Repair, Full Roof Replacement, New Roof Installation, Insurance Claim Estimate (Hail/Storm Damage), Preventative Maintenance, Other. Store in 'collectedAiData.serviceTypeRequested'
                    6.  **Current Roof Condition:** (If applicable, e.g., for roofing services) - Offer options: Storm Damage (Hail/Wind), Visible Leaks, Age-Related Wear, No Issues (Information Search Only), Old/Damaged Roof, Needs Professional Inspection. Store in 'collectedAiData.currentRoofCondition'
                    7.  **Address:** (e.g., "What's the project address?") - Store in 'collectedAiData.address'
                    8.  **Preferred Inspection/Project Start Date:** (e.g., "When would you ideally like the inspection or project to start?") - Format MM-DD-YYYY. Store in 'collectedAiData.preferredDate'

                    **Lead Source & Qualification:**
                    - Set 'collectedAiData.specificLeadSource' to "AI Chatbot" by default, unless the user specifies otherwise.
                    - Determine 'collectedAiData.leadSegmentationQualification':
                        - If 'service_type_requested' is "Insurance Claim Estimate (Hail/Storm Damage)" or "Roof Repair" or "Visible Leaks" or "Old/Damaged Roof", set to "High Priority (Hot Lead)".
                        - If 'service_type_requested' is "Full Roof Replacement" or "New Roof Installation", set to "Medium Priority (Warm Lead)".
                        - Otherwise, set to "Low Priority (Cold Lead)".

                    **Special Instructions:**
                    - Ask questions one at a time.
                    - If the user offers multiple pieces of information at once, acknowledge them but still try to guide the conversation one step at a time where possible.
                    - If at any point the user expresses a desire to speak with a human directly, offer the phone number: "+1 (430) 444-5162". Example response: "I can help with that! You can reach our specialists directly at +1 (430) 444-5162. Would you like me to note that you'll be calling?"
                    - Once you have gathered ALL the necessary information for the HubSpot form fields (Name, Email, Phone, Property Type, Service Type, Address, Preferred Date), provide a concluding summary and then use the command: **[PROCEED_TO_FORM]**
                    - Example concluding statement before the command: "Excellent, I have all the details needed to get your project started! To finalize, please complete the brief form below."

                    **Conversation History (for context):**
                    ${JSON.stringify(conversationHistory)}
                `;

                const response = await fetch(API_BACKEND_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: promptForBackend })
                });

                hideTypingIndicator(); 

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status} - ${await response.text()}`);
                }

                const data = await response.json();
                let aiResponse = data.text; 

                // --- Extract data and update collectedAiData ---
                // This is a simplified extraction. A more robust solution might involve regex or structured output from the AI.
                // We'll try to parse the response for keywords and values.
                
                // Update collectedAiData based on the AI's response and the prompt instructions
                // This part is tricky as the AI's response format can vary. We rely on the prompt to guide it.
                
                // Attempt to extract basic info if present in the response or implied by the conversation flow
                if (userInput.toLowerCase().includes('my name is')) {
                    collectedAiData.name = userInput.substring(userInput.toLowerCase().indexOf('my name is') + 11).trim().split('.')[0];
                } else if (userInput.toLowerCase().includes('i am')) {
                     collectedAiData.name = userInput.substring(userInput.toLowerCase().indexOf('i am') + 4).trim().split('.')[0];
                }
                // More sophisticated parsing would be needed for real-world use.
                // For now, we rely on the AI to explicitly state the info it wants to store.

                // Check if the AI response contains the trigger to proceed
                if (aiResponse.includes('[PROCEED_TO_FORM]')) {
                    const cleanResponse = aiResponse.replace('[PROCEED_TO_FORM]', '').trim();
                    
                    // Add the last user input and AI response to history for summary generation
                    conversationHistory.push({ role: 'user', parts: [{ text: userInput }] });
                    conversationHistory.push({ role: 'model', parts: [{ text: cleanResponse }] });

                    // Attempt to populate collectedAiData from history before calling HubSpot
                    // This requires parsing the conversationHistory for the info the AI collected.
                    // A better approach is for the AI to return structured data (like JSON)
                    // For now, we'll simulate based on the prompt's instructions.
                    
                    // Re-parse conversation history to populate collectedAiData (simplistic approach)
                    conversationHistory.forEach(msg => {
                        const text = msg.parts[0].text.toLowerCase();
                        if (msg.role === 'user') { // User inputs
                            if (text.startsWith('my name is') || text.startsWith('i am')) {
                                collectedAiData.name = text.replace(/^(my name is|i am)\s*/, '').split(',')[0].trim();
                            } else if (text.includes('@') && text.includes('.')) {
                                collectedAiData.email = text.match(/[\w.-]+@[\w.-]+\.\w+/)?.[0];
                            } else if (text.match(/^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/)) {
                                collectedAiData.phone = text.match(/^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/)[0];
                            } else if (text.includes('property type') || text.includes('residential') || text.includes('commercial')) {
                                if (text.includes('residential (single-family)')) collectedAiData.propertyType = 'Residential (Single-Family)';
                                else if (text.includes('residential (multi-family/apartments)')) collectedAiData.propertyType = 'Residential (Multi-Family/Apartments)';
                                else if (text.includes('small commercial')) collectedAiData.propertyType = 'Small Commercial (Office/Retail)';
                                else if (text.includes('large commercial')) collectedAiData.propertyType = 'Large Commercial (Industrial/Retail)';
                                else if (text.includes('institutional')) collectedAiData.propertyType = 'Institutional (School/Church)';
                                else if (text.includes('hoa')) collectedAiData.propertyType = 'Homeowners Association (HOA)';
                            } else if (text.includes('service type') || text.includes('looking for')) {
                                if (text.includes('free inspection')) collectedAiData.serviceTypeRequested = 'Free Inspection';
                                else if (text.includes('roof repair')) collectedAiData.serviceTypeRequested = 'Roof Repair';
                                else if (text.includes('full roof replacement')) collectedAiData.serviceTypeRequested = 'Full Roof Replacement';
                                else if (text.includes('new roof installation')) collectedAiData.serviceTypeRequested = 'New Roof Installation';
                                else if (text.includes('insurance claim estimate')) collectedAiData.serviceTypeRequested = 'Insurance Claim Estimate (Hail/Storm Damage)';
                                else if (text.includes('preventative maintenance')) collectedAiData.serviceTypeRequested = 'Preventative Maintenance';
                                else if (text.includes('other')) collectedAiData.serviceTypeRequested = 'Other';
                            } else if (text.includes('roof condition') || text.includes('storm damage') || text.includes('visible leaks')) {
                                if (text.includes('storm damage')) collectedAiData.currentRoofCondition = 'Storm Damage (Hail/Wind)';
                                else if (text.includes('visible leaks')) collectedAiData.currentRoofCondition = 'Visible Leaks';
                                else if (text.includes('age-related wear')) collectedAiData.currentRoofCondition = 'Age-Related Wear';
                                else if (text.includes('no issues')) collectedAiData.currentRoofCondition = 'No Issues (Information Search Only)';
                                else if (text.includes('old/damaged roof')) collectedAiData.currentRoofCondition = 'Old/Damaged Roof';
                                else if (text.includes('needs professional inspection')) collectedAiData.currentRoofCondition = 'Needs Professional Inspection';
                            } else if (text.includes('address is') || text.includes('project address')) {
                                collectedAiData.address = text.substring(text.indexOf('address') + 7).trim().split(',')[0];
                            } else if (text.match(/\d{1,2}-\d{1,2}-\d{4}/)) { // Matches MM-DD-YYYY
                                collectedAiData.preferredDate = text.match(/\d{1,2}-\d{1,2}-\d{4}/)[0];
                            }
                        } else if (msg.role === 'model') { // AI responses
                             if (text.includes('my name is') || text.includes('i am')) {
                                collectedAiData.name = text.replace(/^(my name is|i am)\s*/, '').split(',')[0].trim();
                            } else if (text.includes('@') && text.includes('.')) {
                                collectedAiData.email = text.match(/[\w.-]+@[\w.-]+\.\w+/)?.[0];
                            } else if (text.match(/^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/)) {
                                collectedAiData.phone = text.match(/^\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}$/)[0];
                            } else if (text.includes('property type') || text.includes('residential') || text.includes('commercial')) {
                                if (text.includes('residential (single-family)')) collectedAiData.propertyType = 'Residential (Single-Family)';
                                else if (text.includes('residential (multi-family/apartments)')) collectedAiData.propertyType = 'Residential (Multi-Family/Apartments)';
                                else if (text.includes('small commercial')) collectedAiData.propertyType = 'Small Commercial (Office/Retail)';
                                else if (text.includes('large commercial')) collectedAiData.propertyType = 'Large Commercial (Industrial/Retail)';
                                else if (text.includes('institutional')) collectedAiData.propertyType = 'Institutional (School/Church)';
                                else if (text.includes('hoa')) collectedAiData.propertyType = 'Homeowners Association (HOA)';
                            } else if (text.includes('service type') || text.includes('looking for')) {
                                if (text.includes('free inspection')) collectedAiData.serviceTypeRequested = 'Free Inspection';
                                else if (text.includes('roof repair')) collectedAiData.serviceTypeRequested = 'Roof Repair';
                                else if (text.includes('full roof replacement')) collectedAiData.serviceTypeRequested = 'Full Roof Replacement';
                                else if (text.includes('new roof installation')) collectedAiData.serviceTypeRequested = 'New Roof Installation';
                                else if (text.includes('insurance claim estimate')) collectedAiData.serviceTypeRequested = 'Insurance Claim Estimate (Hail/Storm Damage)';
                                else if (text.includes('preventative maintenance')) collectedAiData.serviceTypeRequested = 'Preventative Maintenance';
                                else if (text.includes('other')) collectedAiData.serviceTypeRequested = 'Other';
                            } else if (text.includes('roof condition') || text.includes('storm damage') || text.includes('visible leaks')) {
                                if (text.includes('storm damage')) collectedAiData.currentRoofCondition = 'Storm Damage (Hail/Wind)';
                                else if (text.includes('visible leaks')) collectedAiData.currentRoofCondition = 'Visible Leaks';
                                else if (text.includes('age-related wear')) collectedAiData.currentRoofCondition = 'Age-Related Wear';
                                else if (text.includes('no issues')) collectedAiData.currentRoofCondition = 'No Issues (Information Search Only)';
                                else if (text.includes('old/damaged roof')) collectedAiData.currentRoofCondition = 'Old/Damaged Roof';
                                else if (text.includes('needs professional inspection')) collectedAiData.currentRoofCondition = 'Needs Professional Inspection';
                            } else if (text.includes('address is') || text.includes('project address')) {
                                collectedAiData.address = text.substring(text.indexOf('address') + 7).trim().split(',')[0];
                            } else if (text.match(/\d{1,2}-\d{1,2}-\d{4}/)) { 
                                collectedAiData.preferredDate = text.match(/\d{1,2}-\d{1,2}-\d{4}/)[0];
                            }
                        }
                    });

                    // Determine priority based on collected data
                    if (collectedAiData.serviceTypeRequested === 'Insurance Claim Estimate (Hail/Storm Damage)' || 
                        collectedAiData.currentRoofCondition === 'Storm Damage (Hail/Wind)' || 
                        collectedAiData.currentRoofCondition === 'Visible Leaks' ||
                        collectedAiData.currentRoofCondition === 'Old/Damaged Roof') {
                        collectedAiData.leadSegmentationQualification = 'High Priority (Hot Lead)';
                    } else if (collectedAiData.serviceTypeRequested === 'Full Roof Replacement' || collectedAiData.serviceTypeRequested === 'New Roof Installation') {
                        collectedAiData.leadSegmentationQualification = 'Medium Priority (Warm Lead)';
                    } else {
                        collectedAiData.leadSegmentationQualification = 'Low Priority (Cold Lead)';
                    }
                    collectedAiData.specificLeadSource = collectedAiData.specificLeadSource || 'AI Chatbot'; // Default lead source

                    addMessage(cleanResponse, 'ai'); 
                    initializeHubSpotForm(); // Trigger the HubSpot form display
                } else {
                    addMessage(aiResponse, 'ai'); 
                    conversationHistory.push({ role: 'model', parts: [{ text: aiResponse }] });
                    showInputArea(true); 
                }

            } catch (error) {
                console.error("Error interacting with AI backend:", error);
                addMessage("I'm sorry, I encountered an error. Please try again in a moment.", 'ai');
                showInputArea(true); 
            } finally {
                isWaitingForResponse = false; 
            }
        };
        
        // Handler for when the user submits input in the chat
        const handleUserSubmit = () => {
            const inputElement = chatInputArea.querySelector('#chat-input');
            const userInput = inputElement.value.trim();
            inputElement.value = ''; 
            callAIAssistant(userInput);
        };

        // Initialize the chat conversation
        const startConversation = () => {
            const initialMessage = "Howdy! I'm your AI Project Assistant from FDG Constructions. Ready to plan your next big project? Let's start with your name!";
            addMessage(initialMessage, 'ai');
            conversationHistory.push({ role: 'model', parts: [{ text: initialMessage }] });
            showInputArea(true); 

            const sendBtn = document.getElementById('send-chat-btn');
            const inputField = document.getElementById('chat-input');

            sendBtn.addEventListener('click', handleUserSubmit);
            inputField.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); 
                    handleUserSubmit();
                }
            });
        };

        // Start the conversation when the DOM is ready
        startConversation();

        // Close modal if clicking outside the content
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = "none";
            }
        }
    });
    </script>
</body>
</html>